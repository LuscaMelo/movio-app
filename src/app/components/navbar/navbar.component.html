<div class="text-white w-full fixed top-0 left-0 z-50 transition-all duration-500" [ngClass]="{
    'bg-dark/90 backdrop-blur-sm shadow-xl shadow-[#0000007d]': scrolled || showSearch,
    'bg-transparent': !scrolled && !showSearch,
    'h-[140px]': showSearch,
    'h-[80px]': !showSearch
  }">

    <div class="max-w-[1500px] mx-auto px-3 w-full h-full flex flex-col justify-start relative">

        <!-- Barra principal -->
        <div class="w-full h-[80px] flex justify-between items-center relative z-20">

            <!-- Logo -->
            <div class="relative z-10">
                <a routerLink="/"><img class="max-w-[130px]" src="/logo.png" alt="logotipo da Movio"></a>
            </div>

            <!-- Navegação desktop -->
            <nav class="flex-1 justify-center hidden xl:flex">
                <ul class="flex gap-6 text-md font-semibold">
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/">Início</a>
                    </li>
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/categorias">Categorias</a>
                    </li>
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/mais-populares">Populares</a>
                    </li>
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/tendencias-da-semana">Tendências</a>
                    </li>
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/mais-bem-avaliados">Mais bem avaliados</a>
                    </li>
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/em-cartaz">Em cartaz</a>
                    </li>
                    <li class="hover:text-brand duration-300 cursor-pointer">
                        <a routerLink="/em-breve">Em breve</a>
                    </li>
                </ul>
            </nav>

            <!-- Ícones e input -->
            <div class="flex items-center gap-4 relative">
                <div class="flex items-center gap-3">
                    <!-- Favoritos -->
                    <a routerLink="/favoritos" class="relative inline-block">
                        <i class="fa-solid fa-heart hover:text-brand duration-300 cursor-pointer text-xl"></i>

                        <!-- Badge -->
                        <span *ngIf="favoritesCount() > 0"
                            class="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-semibold rounded-full w-5 h-5 flex items-center justify-center">
                            {{ favoritesCount() }}
                        </span>
                    </a>

                    <!-- Input desktop -->
                    <div class="relative w-full max-w-md border border-zinc-500 rounded-full hidden lg:flex">
                        <input type="text" placeholder="Buscar por filme" [(ngModel)]="searchQuery"
                            (keyup.enter)="searchMovies()"
                            class="w-full py-2 pl-4 pr-12 rounded-full bg-transparent duration-300 focus:outline-none transition" />
                        <button (click)="searchMovies()"
                            class="absolute right-1 top-1/2 -translate-y-1/2 bg-zinc-100 text-zinc-900 duration-300 hover:bg-zinc-400 text-white rounded-full w-8 h-8 flex items-center justify-center">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </div>

                    <!-- Lupa mobile -->
                    <i class="fa-solid fa-magnifying-glass text-xl cursor-pointer hover:text-zinc-400 duration-300 lg:hidden"
                        (click)="toggleSearch()"></i>
                </div>

                <!-- Botão mobile -->
                <button class="xl:hidden text-2xl" type="button" aria-label="Abrir menu" (click)="toggleMenu()">
                    <i class="fa-solid fa-bars"></i>
                </button>
            </div>

        </div>

        <!-- Input mobile -->
        <div class="absolute left-0 w-full flex lg:hidden justify-center items-center overflow-hidden top-[80px] transition-all duration-500 px-3"
            [ngClass]="showSearch ? 'max-h-32 opacity-100' : 'max-h-0 opacity-0 pointer-events-none'">
            <div class="relative w-full h-full border border-zinc-700 rounded-full flex items-center">
                <input type="text" placeholder="Buscar por filme" [(ngModel)]="searchQuery"
                    (keyup.enter)="searchMovies()"
                    class="w-full h-full py-3 pl-4 pr-12 rounded-full bg-transparent text-white focus:outline-none transition" />
                <button (click)="searchMovies()"
                    class="absolute right-[6px] top-1/2 -translate-y-1/2 bg-zinc-100 text-zinc-900 hover:bg-zinc-400 text-white rounded-full w-8 h-8 flex items-center justify-center">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </div>
        </div>

    </div>

    <!-- Overlay menu mobile -->
    <div class="fixed top-0 left-0 h-[110dvh] w-full bg-black/85 transition-all duration-500 z-40 xl:hidden"
        [ngClass]="menuOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'" (click)="toggleMenu()"></div>

    <!-- Menu mobile -->
    <div class="absolute top-0 right-0 w-full md:w-[65%] h-[110dvh] bg-dark shadow-lg transition-all duration-300 xl:hidden z-50"
        [ngClass]="menuOpen ? 'translate-x-0' : '-translate-x-[-105vw] pointer-events-none'">

        <i class="fa-solid fa-xmark absolute right-5 top-7 text-2xl cursor-pointer" (click)="toggleMenu()"></i>

        <div class="p-3 flex flex-col gap-4 text-2xl items-center justify-center h-[80%]">
            <div class="mb-10 pl-3">
                <img class="max-w-[130px]" src="/logo.png" alt="logotipo da Movio">
            </div>

            <ul class="text-center" (click)="toggleMenu()">
                <a routerLink="/">
                    <li class="hover:text-brand duration-300 cursor-pointer">Início</li>
                </a>
                <a routerLink="/categorias">
                    <li class="hover:text-brand duration-300 cursor-pointer">Categorias</li>
                </a>
                <a routerLink="/mais-populares">
                    <li class="hover:text-brand duration-300 cursor-pointer">Populares</li>
                </a>
                <a routerLink="/tendencias-da-semana">
                    <li class="hover:text-brand duration-300 cursor-pointer">Tendências</li>
                </a>
                <a routerLink="/mais-bem-avaliados">
                    <li class="hover:text-brand duration-300 cursor-pointer">Mais bem avaliados</li>
                </a>
                <a routerLink="/em-cartaz">
                    <li class="hover:text-brand duration-300 cursor-pointer">Em cartaz</li>
                </a>
                <a routerLink="/em-breve">
                    <li class="hover:text-brand duration-300 cursor-pointer">Em breve</li>
                </a>
            </ul>
        </div>
    </div>

</div>